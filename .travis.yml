language: java # set desired language

sudo: true
dist: trusty

jdk:
  - oraclejdk8
addons:
apt:
  sources:
    - google-chrome
  packages:
    - google-chrome-stable

addons:
   firefox: "52.0.2" # if your project contains tests need to be run on firefox include these lines


before_install:

  - "/sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -ac -screen 0 1280x1024" # running virtual display on desired port with desired settings
  #- sleep 3


before_script:
  - git config --global user.token = $GITHUB_TOKEN
  # Selenium server
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  #- wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
  #- sudo dpkg -i google-chrome*.deb
  - sleep 3
  - sudo apt-get update > /dev/null
  - java -jar selenium-server-standalone-3.0.1.jar > /dev/null 2>/dev/null & # starting selenium-server
  - sleep 10

script:
  - echo "Extracting firefox and setting PATH variable..."
  - tar -xjf /tmp/firefox-52.0.2.tar.bz2 --directory /tmp
  - export PATH="/tmp/firefox:$PATH"
  - echo "Using firefox version `firefox --version`"
  - chmod +x /home/travis/build/Orfik/N2PS-AutoTests/src/test/resources/geckodriver_v.14
  - export PATH="$HOME/.chrome/chromium/chrome-linux/chrome:$PATH"
  - echo "Using chrome version `chrome --version`"
  - chmod +x /home/travis/build/Orfik/N2PS-AutoTests/src/test/resources/chromedriver
  - mvn help:active-profiles
  - mvn test
  - mvn site
  - chmod +x /home/travis/build/Orfik/N2PS-AutoTests/target/allure-results
  #- mvn jetty:run

after_success:
  - mkdir reports && cd reports
  - git clone --branch=master git@github.com:Orfik:N2PS-AutoTests && cd reports
  #- git rm -rf doc/*
  #- git rm -rf report/*
  #- cp -rf ../../doc doc
  #- cp -rf ../../report report
  - git add doc/*
  - git add report/*
  - git commit -m "Documentation and reports updated"
  - git push git@github.com:Orfik/N2PS-AutoTests reports
env:
global:
secure: "M2BecZ2IFdndUKGYt4nOQlcDZjz8wPGfW1Wafc3aiRW3xEDnaYhChfcR1Ioa+LoFH/X+k
       goZEvA0PqhtdX1bYxkWhkEoUavfUABE9cQycW9Y4Tcs3/bYII/j+x+lPevyIKJfkEwU3K3A2FpRHwNyD
       JJieUnSFOphONhKIpRuC8BcrIddnSQrM4T5SbWFTSk9xCUwIR1m9Y4+oyED7MwMxplbIoKty1lYHtSTz
       HuOau1Z41ly5apoBxQmLK5Gxy51xJyyG9sF6r0ooKHtqzbMm72kJzlM07a1MAMl7GWJho5yqI2Zgnyi0
       S4xyRaB3gqndXgDYO8yTsS4MSQJIemYVHLxPOu08G5BHhOQ5R5d1csA8wjwGrfDxwf+c3vcVgZqBYn7n
       5bB0ZwKlPlrJzsVErZdAu70v+y5XCEw9AAt33m52G5Xvwe1PvNf9eNO8FST8b/O/7RSrN3sI3ph6b3wt
       WH9hj61CcWltkHRACG/bsbszR5TTWEgtNqutLLKkkQHfkvih7XA96WMh5t1fnpPq3KW1ZC69al9covPo
       TCFIMGp9RWbPE8hPicchAgIn5ZjR30AbZbsn/ZolVesDVNF8oorSyqEvzhFDjykqztYpI3dD/TbYV6SV
       PuVam9Cc3eCQaBf5OVxqlPLbsHTmth/qqo7LB2s4GWNWLK/L31aQn4="
